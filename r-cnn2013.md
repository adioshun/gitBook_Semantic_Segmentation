|논문명|Rich feature hierarchies for accurate object detection and semantic segmentation|
|-|-|
|저자(소속)|Ross Girshick(UC Berkeley)|
|학회/년도|LSVRC 2013, [논문](https://arxiv.org/pdf/1311.2524.pdf)|
|키워드||
|참고|[발표자료#1](http://web.cs.ucdavis.edu/~yjlee/teaching/ecs289h-fall2014/CollinMcCarthy_RCNN.pdf),[잘표자료#2](https://courses.cs.washington.edu/courses/cse590v/14au/cse590v_wk1_rcnn.pdf), [라온피플블로그](http://laonple.blog.me/220692793375), [코드_Python](https://github.com/rbgirshick/fast-rcnn)|

---
> [텐서플로우 블로그](https://tensorflow.blog/2017/06/05/from-r-cnn-to-mask-r-cnn/)

이미지를 분류하는 것보다 이미지 안에 어떤 물체들이 들어 있는지를 구분해내는 것이 훨씬 어려운 작업입니다. R-CNN은 이를 위해 몇단계를 거쳐 임무를 처리합니다. 먼저 가능한 이미지 영역을 찾아내는 리전 프로포잘region proposal 혹은 바운딩 박스bounding box를 만드는 단계가 있습니다. 바운딩 박스를 찾기 위해 셀렉티브 서치selective search 알고리즘을 사용합니다. 가령 색상이나 강도 패턴 등이 비슷한 인접한 픽셀을 합치는 방식입니다. 그런 다음 추출한 바운딩 박스를(대략 2,000여개) CNN의 입력으로 주입하기 위해 강제로 사이즈를 일원화시킵니다. 여기서 사용한 CNN은 미리 훈련된 AlexNet의 변형된 버전입니다. CNN의 마지막 단계에서 서포트 벡터 머신support vector machine을 사용하여 이미지를 분류합니다. 그리고 최종적으로 분류된 오브젝트의 바운딩 박스 좌표를 더 정확히 맞추기 위해 선형 회귀linear regression 모델을 사용합니다.

---
>  라온피플 블로그 

## 1. 동작 방식 

![](http://i.imgur.com/Wwv323r.png)


- 입력 영상(1)으로부터 (Selective Search 이용 하여) 약 2000개의 후보 영역(2)을 만든다 
- AlexNet 이용을 위해 입력 이미지 크기 조정 (후보 영역을 224x224 크기로 변환, warped Region)
- (3)변형된 AlexNet을 이용하여 해당 영상을 대표할 수 있는 CNN feature vector 생성 
- (4)linear SVM을 이용해 해당 영역을 분류

## 2. 성능 향상과 학습 방법 

> 성능 평가를 PASCAL VOC를 사용하였는데, PASCAL VOC의 경우 label이 붙은 데이터의 양이 ILSVRC(ImageNet)보다 상대적으로 적어 PreTrain시는 ImageNET활용

![](http://i.imgur.com/DXcDpO8.png)
- ILSVRC 결과를 사용하여 CNN을 pre-training을 하였다. 
    - Pre-training에는 bounding box를 사용하지는 않았고, 단지 label 있는 ILSVRC data를 이용해 CNN에 있는 파라미터들이 적절한 값을 갖도록 하였다.

- 다음은 warped VOC를 이용해 CNN을 fine tuning을 한다. 
    - 이 때는 ground truth 데이터와 적어도 0.5 IoU(Intersection over Union: 교집합/합집합) 이상 되는 region 들만 postive로 하고 나머지는 전부 negative로 하여 fine tuning을 시행한다.
    -  이 때 모든 class에 대해 32개의 positive window와 96개의 background window를 적용하여 128개의 mini-batch로 구성을 한다.

- 마지막으로 linear classifier의 성능을 개선을 위해 hard negative mining 방법을 적용하였다.


---
# 별첨
Regionlets
- Start with selective search.
- Define sub-parts of regions whose position/resolution are relative and normalized to a detection window, as the basic units to extract appearance features.
- Features: HOG, LBP, Covarience

![](http://i.imgur.com/undefined.png)

--- 
